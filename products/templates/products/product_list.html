{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Product Listing</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">

  <h1 class="mb-4">üõç Product Listing</h1>

  <!-- üîé Search & Filters -->
  <form method="get" class="row g-3 mb-4">
    <div class="col-md-3">
      <input type="text" name="q" value="{{ search_query }}" class="form-control" placeholder="Search name or brand">
    </div>
    <div class="col-md-2">
      <input type="number" name="min_price" value="{{ min_price }}" class="form-control" placeholder="Min Price">
    </div>
    <div class="col-md-2">
      <input type="number" name="max_price" value="{{ max_price }}" class="form-control" placeholder="Max Price">
    </div>
    <div class="col-md-3">
      <select name="availability" class="form-select">
        <option value="">All</option>
        <option value="available" {% if availability == 'available' %}selected{% endif %}>Available</option>
        <option value="unavailable" {% if availability == 'unavailable' %}selected{% endif %}>Unavailable</option>
      </select>
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-primary w-100">Search</button>
    </div>
  </form>

  <!-- üìä Total Results -->
  <p class="text-muted">Total Results Found: <strong>{{ total_results }}</strong></p>

  <!-- üì¶ Product List -->
  <div class="row">
    {% for product in page_obj %}
      <div class="col-md-4 mb-3">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <h5 class="card-title">{{ product.name }}</h5>
            <p class="card-text">
              <strong>Brand:</strong> {{ product.brand }}<br>
              <strong>Price:</strong> ${{ product.price }}<br>
              <strong>Status:</strong> 
              {% if product.is_available %}
                <span class="badge bg-success">Available</span>
              {% else %}
                <span class="badge bg-danger">Unavailable</span>
              {% endif %}
            </p>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-center">No products found.</p>
    {% endfor %}
  </div>

  <!-- üìÑ Pagination -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      {% if page_obj.has_previous %}
        <li class="page-item"><a class="page-link" href="?page=1&q={{ search_query }}&min_price={{ min_price }}&max_price={{ max_price }}&availability={{ availability }}">First</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}&q={{ search_query }}&min_price={{ min_price }}&max_price={{ max_price }}&availability={{ availability }}">Previous</a></li>
      {% endif %}

      <li class="page-item disabled"><a class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</a></li>

      {% if page_obj.has_next %}
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}&q={{ search_query }}&min_price={{ min_price }}&max_price={{ max_price }}&availability={{ availability }}">Next</a></li>
        <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}&q={{ search_query }}&min_price={{ min_price }}&max_price={{ max_price }}&availability={{ availability }}">Last</a></li>
      {% endif %}
    </ul>
  </nav>

</div>
</body>
</html>
